<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>易管银务-银行雇员主页</title>
    <!-- css 样式 -->
    <script src="js/jquery.js"></script>
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/style-responsive.css" rel="stylesheet">
    <link href="css/default-theme.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/bootstrap-reset.css" rel="stylesheet">
</head>

<body class="sticky-header">
<section>
    <!-- 侧边菜单 -->
    <div class="sidebar-left">
        <div class="sidebar-left-info">
            <div class="search-field"></div>

            <!-- 菜单列表 -->
            <ul class="nav nav-pills nav-stacked side-navigation">
                <!-- 子列表: 银行账户管理 -->
                <li class="menu-list"> <a href=""><i class="fa fa-file-text"></i> <span>银行账户管理</span></a>
                    <ul class="child-list">
                        <li><a href="manage_staff_注册账户.html">注册账户</a></li>
                        <li><a href="manage_staff_注销账户.html">注销账户</a></li>
                    </ul>
                </li>
                <!-- 子列表: 存取款与转账 -->
                <li class="menu-list"> <a href=""><i class="fa fa-file-text"></i> <span>存取款与转账</span></a>
                    <ul class="child-list">
                        <li><a href="manage_staff_存款.html">存款</a></li>
                        <li><a href="manage_staff_取款.html">取款</a></li>
                        <li><a href="manage_staff_转账.html">转账</a></li>
                        <li><a href="manage_staff_查询.html">查询</a></li>
                    </ul>
                </li>
                <!-- 子列表: 日报系统 -->
                <li class="menu-list"> <a href=""><i class="fa fa-file-text"></i> <span>日报系统</span></a>
                    <ul class="child-list">
                        <li><a href="manage_staff_我的日报.html">我的日报</a></li>
                    </ul>
                </li>
            </ul>

        </div>
    </div>

    <!-- 顶栏 -->
    <div class="body-content">
        <div class="header-section">
            <!-- logo与标题 -->
            <div class="logo dark-logo-bg"> <a href="manage_personalUser.html"> <img src="img/logo-icon.png" alt="">
                <span class="brand-name" style="font-size: 15px; font-weight: bold;">银行雇员主页</span>
            </a> </div>
            <div class="icon-logo dark-logo-bg hidden-xs hidden-sm"> <a href="manage_personalUser.html"><img src="img/logo-icon.png" alt=""> </a> </div>
            <!-- 侧边栏隐藏按钮 -->
            <a class="toggle-btn"><i class="fa fa-outdent"></i></a>
            <div class="kouhao">用我们的智慧，为您创造财富</div>

            <!-- 右上角菜单 -->
            <div class="notification-wrap">
                <div class="right-notification">
                    <ul class="notification-menu">
                        <!-- 当前登录用户名 -->
                        <li> <a id="username_login" onclick="showUsername(event)">欢迎</a> </li>
                        <!-- 用户设置 -->
                        <li class="dropdown">
                            <a href="javascript:" data-toggle="dropdown" class="dropdown-toggle" aria-expanded="false"> <i class="fa  fa-cogs"></i> 用户设置 <b class=" fa fa-angle-down"></b> </a>
                            <ul role="menu" class="dropdown-menu language-switch">
                                <li> <a href="manage_staff_员工密码修改.html">密码修改</a> </li>
                                <li> <a onclick="deleteStaff(event)">用户注销</a></li>
                            </ul>
                        </li>
                        <li> <a href="login.html" class="btn btn-default  dropdown-toggle"> <i class="fa fa-sign-out"></i>退出登录 </a> </li>
                    </ul>
                </div>
            </div>
        </div>


        <!---------------- 变化的内容填在下面区域 ------------------>
        <div class="page-head">
            <ol class="breadcrumb">
                <li><a href="#">日报系统</a></li>
                <li class="active">我的日报</li>
            </ol>
            <h3>我的日报</h3>
        </div>

        <div class="wrapper">
            <div class="panel">
                <div class="panel-body">
                    <div class="form1 searchbox">
                        <ul class="row">
                            <li class="col-xs-2"> <a class="btn btn-primary" onclick="MyOp(event)">我的操作日志</a> </li>
                            <li class="col-xs-2"> <a class="btn btn-primary" onclick="OperatorOp(event)">前台操作日志</a> </li>
                            <li class="col-xs-2"> <a class="btn btn-primary" onclick="DepartmentOp(event)">部门操作日志</a> </li>
                            <li class="col-xs-2"> <a class="btn btn-primary" onclick="SystemOp(event)">系统操作日志</a> </li>
                        </ul>
                    </div>
                </div>

                <table class="table m-b-20">
                    <thead>
                    <tr><th>操作用户</th><th>用户类型</th><th>操作类型</th><th>操作账户</th><th>余额变动</th><th>时间</th></tr>
                    </thead>
                    <tbody>
                    <tr>
                        <th><input id="table_username_0" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_0" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_0" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_0" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_0" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_0" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_1" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_1" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_1" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_1" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_1" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_1" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_2" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_2" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_2" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_2" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_2" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_2" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_3" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_3" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_3" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_3" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_3" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_3" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_4" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_4" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_4" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_4" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_4" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_4" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_5" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_5" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_5" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_5" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_5" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_5" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_6" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_6" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_6" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_6" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_6" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_6" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_7" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_7" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_7" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_7" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_7" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_7" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_8" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_8" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_8" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_8" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_8" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_8" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    <tr>
                        <th><input id="table_username_9" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_role_9" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_op_9" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_account_id_9" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_amount_9" class="forminput" type="text" readonly="readonly"></th>
                        <th><input id="table_timestamp_9" class="forminput" type="text" readonly="readonly"></th>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>
        <!---------------- 变化的内容填在上面区域 ------------------>


    </div>
</section>

<script src="js/bootstrap.js"></script>
<script src="js/echarts.min.js"></script>
<script src="js/scripts.js"></script>
<script src="laydate/laydate.js"></script>
<script>
    lay('#version').html('-v'+ laydate.v);
    laydate.render({
        elem: '#test1'
        ,range: true
        ,theme: '#1890ff'
    });
</script>


<!-- 导入ajax -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    // 显示当前登录的用户名
    function showUsername(evt) {
        var username_login = localStorage.getItem("username_login");
        document.getElementById("username_login").innerHTML = "努力工作 " + username_login;
    }

    // 注销用户按钮确认弹框
    function deleteStaff(evt) {
        if (window.confirm("确认注销当前雇员用户？")) {
            var username = localStorage.getItem("username_login");

            // 使用 ajax 发送 post 请求
            $.ajax({
                url: '/staffs/deleteStaff/username=' + username,
                method: 'POST',
                data: {},
                success: function (data) {
                    console.log(data);

                    // 注销用户成功则跳转回登录界面
                    if (Boolean(data["data"])) {
                        alert("注销雇员用户成功！");
                        window.location.href = "./login.html";
                    }
                    else {
                        alert(data["msg"]);
                    }
                },
                err: function (err) {
                    console.log(err);
                }
            })
        }
    }
    // ---------------- 变化的内容填在下面区域 ------------------

    // 前台管理员: 我的操作日志
    function MyOp(evt) {
        var username_login = localStorage.getItem("username_login");

        // 查询日志
        FLG = true;
        $.ajax({
            url: '/logs/queryLogs/username=' + username_login,
            method: 'POST',
            data: {},
            contentType: "application/json",
            async: false,
            success: function (data) {
                console.log(data);

                if(String(data["code"]) === "20041") {
                    console.log(data);

                    // 在表格中展示流水记录
                    for (var i = 0; i < 10; i++) {
                        if (i < data["data"].length) {
                            document.getElementById("table_username_" + i.toString()).value = data["data"][i]["username"];
                            document.getElementById("table_role_" + i.toString()).value = data["data"][i]["role"];
                            document.getElementById("table_op_" + i.toString()).value = data["data"][i]["op"];
                            document.getElementById("table_account_id_" + i.toString()).value = data["data"][i]["account_id"];
                            if (data["data"][i]["amount"] > 0) {
                                document.getElementById("table_amount_" + i.toString()).value = '+' + data["data"][i]["amount"].toString();
                            } else {
                                document.getElementById("table_amount_" + i.toString()).value = data["data"][i]["amount"].toString();
                            }
                            document.getElementById("table_timestamp_" + i.toString()).value = data["data"][i]["timestamp"];
                        }
                        else {
                            document.getElementById("table_username_" + i.toString()).value = "";
                            document.getElementById("table_role_" + i.toString()).value = "";
                            document.getElementById("table_op_" + i.toString()).value = "";
                            document.getElementById("table_account_id_" + i.toString()).value = "";
                            document.getElementById("table_amount_" + i.toString()).value = "";
                            document.getElementById("table_timestamp_" + i.toString()).value = "";
                        }
                    }
                }
                else if(String(data["code"]) === "20040") {
                    alert(data["msg"]);
                    FLG = false;
                }
            },
            err: function (err) {
                console.log(err);
            }
        })
    }

    // 银行经理: 前台操作日志
    function OperatorOp(evt) {
        var type_login = localStorage.getItem("type_login");
        var department_login = localStorage.getItem("department_login");

        if (type_login === "operator") {
            alert("银行经理以上的雇员才可使用本功能！");
            return;
        }

        // 查询日志
        FLG = true;
        $.ajax({
            url: '/logs/queryLogs/department=' + department_login + "&i=1",
            method: 'POST',
            data: {},
            contentType: "application/json",
            async: false,
            success: function (data) {
                console.log(data);

                if(String(data["code"]) === "20041") {
                    console.log(data);

                    // 在表格中展示流水记录
                    for (var i = 0; i < 10; i++) {
                        if (i < data["data"].length) {
                            document.getElementById("table_username_" + i.toString()).value = data["data"][i]["username"];
                            document.getElementById("table_role_" + i.toString()).value = data["data"][i]["role"];
                            document.getElementById("table_op_" + i.toString()).value = data["data"][i]["op"];
                            document.getElementById("table_account_id_" + i.toString()).value = data["data"][i]["account_id"];
                            if (data["data"][i]["amount"] > 0) {
                                document.getElementById("table_amount_" + i.toString()).value = '+' + data["data"][i]["amount"].toString();
                            } else {
                                document.getElementById("table_amount_" + i.toString()).value = data["data"][i]["amount"].toString();
                            }
                            document.getElementById("table_timestamp_" + i.toString()).value = data["data"][i]["timestamp"];
                        }
                        else {
                            document.getElementById("table_username_" + i.toString()).value = "";
                            document.getElementById("table_role_" + i.toString()).value = "";
                            document.getElementById("table_op_" + i.toString()).value = "";
                            document.getElementById("table_account_id_" + i.toString()).value = "";
                            document.getElementById("table_amount_" + i.toString()).value = "";
                            document.getElementById("table_timestamp_" + i.toString()).value = "";
                        }
                    }
                }
                else if(String(data["code"]) === "20040") {
                    alert(data["msg"]);
                    FLG = false;
                }
            },
            err: function (err) {
                console.log(err);
            }
        })
    }

    // 银行业务总管: 部门操作日志
    function DepartmentOp(evt) {
        var type_login = localStorage.getItem("type_login");
        var department_login = localStorage.getItem("department_login");

        if (type_login === "operator" || type_login === "manager") {
            alert("银行业务总管以上的雇员才可使用本功能！");
            return;
        }

        // 查询日志
        FLG = true;
        $.ajax({
            url: '/logs/queryLogs/department=' + department_login + "&i=2",
            method: 'POST',
            data: {},
            contentType: "application/json",
            async: false,
            success: function (data) {
                console.log(data);

                if(String(data["code"]) === "20041") {
                    console.log(data);

                    // 在表格中展示流水记录
                    for (var i = 0; i < 10; i++) {
                        if (i < data["data"].length) {
                            document.getElementById("table_username_" + i.toString()).value = data["data"][i]["username"];
                            document.getElementById("table_role_" + i.toString()).value = data["data"][i]["role"];
                            document.getElementById("table_op_" + i.toString()).value = data["data"][i]["op"];
                            document.getElementById("table_account_id_" + i.toString()).value = data["data"][i]["account_id"];
                            if (data["data"][i]["amount"] > 0) {
                                document.getElementById("table_amount_" + i.toString()).value = '+' + data["data"][i]["amount"].toString();
                            } else {
                                document.getElementById("table_amount_" + i.toString()).value = data["data"][i]["amount"].toString();
                            }
                            document.getElementById("table_timestamp_" + i.toString()).value = data["data"][i]["timestamp"];
                        }
                        else {
                            document.getElementById("table_username_" + i.toString()).value = "";
                            document.getElementById("table_role_" + i.toString()).value = "";
                            document.getElementById("table_op_" + i.toString()).value = "";
                            document.getElementById("table_account_id_" + i.toString()).value = "";
                            document.getElementById("table_amount_" + i.toString()).value = "";
                            document.getElementById("table_timestamp_" + i.toString()).value = "";
                        }
                    }
                }
                else if(String(data["code"]) === "20040") {
                    alert(data["msg"]);
                    FLG = false;
                }
            },
            err: function (err) {
                console.log(err);
            }
        })
    }

    // 系统管理员: 系统操作日志
    function SystemOp(evt) {
        var type_login = localStorage.getItem("type_login");

        if (type_login !== "admin") {
            alert("系统管理员才可使用本功能！");
            return;
        }

        // 查询日志
        FLG = true;
        $.ajax({
            url: '/logs/queryLogs',
            method: 'POST',
            data: {},
            contentType: "application/json",
            async: false,
            success: function (data) {
                console.log(data);

                if(String(data["code"]) === "20041") {
                    console.log(data);

                    // 在表格中展示流水记录
                    for (var i = 0; i < 10; i++) {
                        if (i < data["data"].length) {
                            document.getElementById("table_username_" + i.toString()).value = data["data"][i]["username"];
                            document.getElementById("table_role_" + i.toString()).value = data["data"][i]["role"];
                            document.getElementById("table_op_" + i.toString()).value = data["data"][i]["op"];
                            document.getElementById("table_account_id_" + i.toString()).value = data["data"][i]["account_id"];
                            if (data["data"][i]["amount"] > 0) {
                                document.getElementById("table_amount_" + i.toString()).value = '+' + data["data"][i]["amount"].toString();
                            } else {
                                document.getElementById("table_amount_" + i.toString()).value = data["data"][i]["amount"].toString();
                            }
                            document.getElementById("table_timestamp_" + i.toString()).value = data["data"][i]["timestamp"];
                        }
                        else {
                            document.getElementById("table_username_" + i.toString()).value = "";
                            document.getElementById("table_role_" + i.toString()).value = "";
                            document.getElementById("table_op_" + i.toString()).value = "";
                            document.getElementById("table_account_id_" + i.toString()).value = "";
                            document.getElementById("table_amount_" + i.toString()).value = "";
                            document.getElementById("table_timestamp_" + i.toString()).value = "";
                        }
                    }
                }
                else if(String(data["code"]) === "20040") {
                    alert(data["msg"]);
                    FLG = false;
                }
            },
            err: function (err) {
                console.log(err);
            }
        })
    }

    // ---------------- 变化的内容填在上面区域 ------------------
</script>



</body>

</html>